package cn.hba.audit.flume.soc.log.logapt;

import cn.hba.audit.flume.soc.SyslogParse;
import cn.hutool.json.JSONObject;
import cn.hutool.json.JSONUtil;


/**
 * @author ztf
 */
public class SyslogParseApt implements SyslogParse {
    @Override
    public Object parse(String body) {
        return cn.hba.audit.flume.soc.log.logapt.AptParse.parse(body);
    }

    public static void main(String[] args) {
        String log = "<12>Dec  1 18:41:51 slave4 apt: 2019-12-01 18:40:53\t1575196853736\tATD\t192.168.123.5\tNDE\t5868d8cb-473f-43ff-a8d8-cb473f93ff43\tp5p1\t19990502\tweird-behavior\tweird-dns-behavior\tnull\t192.168.81.220\t137\tnetbios-ns\t192.168.81.255\t137\tnetbios-ns\tudp\tdns\tactions-objectives\tQURVLkctRk9YLkNO\tnull\t1\t7\tnull\tThe host 192.168.81.220 is overloaded, query str: ADU.G-FOX.CN\tquery:ADU.G-FOX.CN;answers:;qtype_name:NB;\tToo many DNS requests\tChina\tBeijing\t39.9047,116.4072\tCN\tChina\tBeijing\t39.9047,116.4072\tCN";
        log = "<12>Dec  1 18:41:51 slave4 apt: 2019-12-01 18:41:07\t1575196867576\tATD\t192.168.123.5\tAIS\t8564c349-933e-49f3-bab2-d231a7b6ebe2-n\tp5p1\t0\tnull\tnull\tnull\t192.168.103.22\t57336\tnull\t59.202.42.251\t80\tnull\tTCP\tHTTP\tmalware-download\tnull\tnull\t1\t0\tnull\tnull\tnull\tnull\tChina\tbeijing\t39.9047,116.4072\tCN\tChina\tBeijing\t39.9289,116.3883\tCN";
        log = "<12>Dec  1 18:41:51 slave4 apt: 2019-12-01 18:43:01\t1575196981118\tATD\t192.168.123.5\tNDE\t4836428d-0b2b-4bcc-b642-8d0b2bcbcc8e\tp5p1\t2027265\tbad-unknown\tbad-unknown\tnull\t192.168.103.23\t44398\tnull\t59.202.42.251\t80\thttp\ttcp\thttp\tsecurity-defect\tR0VUIC9saWNlbnNlbmFtZS9zaWduL2VsY2xpY2VuY2VwZGYvY291bnRyeS9namNvbW1vbk1MR0pCMDFBNTVFOTM5QTA0Rjg0Qjg4RTNFODI5QjI2NkRCOS5wZGYgSFRUUC8xLjENCmFjY2VwdDogKi8qDQp1c2VyLWFnZW50OiBNb3ppbGxhLzQuMCAoY29tcGF0aWJsZTsgTVNJRSA2LjA7IFdpbmRvd3MgTlQgNS4xO1NWMSkNCkNhY2hlLUNvbnRyb2w6IG5vLWNhY2hlDQpQcmFnbWE6IG5vLWNhY2hlDQpIb3N0OiA1OS4yMDIuNDIuMjUxDQpDb25uZWN0aW9uOiBrZWVwLWFsaXZlDQoNCg==\tnull\t1\t1\tnull\tDotted Quad Host PDF Request\tmethod:GET;status_code:200;host:59.202.42.251;uri:/licensename/sign/elclicencepdf/country/gjcommonMLGJB01A55E939A04F84B88E3E829B266DB9.pdf;\tDotted Quad Host PDF Request\tChina\tbeijing\t39.9047,116.4072\tCN\tChina\tBeijing\t39.9289,116.3883\tCN";
        log = "<12>Dec  1 18:44:01 slave4 apt: 2019-12-01 18:44:40\t1575197080013\tATD\t192.168.123.5\tNDE\t12e0e1ba-c4b3-4af6-a0e1-bac4b36af695\tp5p1\t2100987\tweb-attack\tweb-attack\tnull\t192.168.124.251\t53418\tnull\t192.168.92.100\t80\thttp\ttcp\thttp\tattempt-attack\tUE9TVCAvanViYS9mcm9udC9wYWdlL2xvYWRub3dhcmVhbWFwZGF0YS5kbz9NbUV3TUQ9NEZVSjE1eVpoUVlhZDBLRDFHcWRhQkFBbzJaNnV0V0pvVWFPMjBtNGVwQl9TRVZkUzVaNHJVSHpTODNiSVR6Qkk2WnR2ai5IVHIzV0ltdlBfM0JIQWJITnhWRHRnN1VFbWt3SXFwelpkam8yUVZJRi5KQ2lyMDRaUXdzcE42SWtLeEFYT0ZTUVN5UWVDdGtWcmVhdk90RktHcnlXd0w4VWNwX1lJWVRvN2tNYUlhLkw2amx4YVpmMm5qSWhfQzdoRXZZbzFmYktpX2lyNjBnaUEzcjRYd29tQXJPWk5iX0hCWEtGVTlFSXlKYzRfLmk2YmNrbVoyTk5YU0hsYldHQ19CVlZVanR1YVUyRHFHZF9HbG1RWjJXVkh5TUk0RGpHcEk1bm5Kd2hfakpKNmVHZmw0VEFOUmJMTUhNNy5jVVQ1dFV4ZC5GcTJJRDdkSmRLZkZjQWo3T1VjN1ZmSERjdGRLVkxpUDZtMnMxeEZTNSBIVFRQLzEuMQ0KSG9zdDogNTkuMjU1LjIyLjY3DQpDb25uZWN0aW9uOiBrZWVwLWFsaXZlDQpYLVJlYWwtSVA6IDU5LjE5My4xMzkuMjANClgtRm9yd2FyZGVkLUZvcjogNTkuMTkzLjEzOS4yMA0KQ29udGVudC1MZW5ndGg6IDANCkFjY2VwdDogKi8qDQpPcmlnaW46IGh0dHA6Ly81OS4yNTUuMj...";
        log = "<12>Dec  1 18:48:41 slave4 apt: 2019-12-01 18:49:00\t1575197340999\tATD\t192.168.123.5\tNDE\td425ff43-b982-44c5-a5ff-43b98294c520\tp5p1\t10080002\tscan\taddress-scan\tnull\t192.168.111.23\t0\tnull\t59.255.8.71\t0\tnull\ttcp\tother\tscan-detect\tc2Nhbm5lZCBwb3J0OiA5ODAxL3RjcA==\tnull\t1\t7\tnull\tlocal\tduration:252.015995;number:25;sample:59.255.8.71, 59.255.89.43, 59.255.89.43, 59.255.104.147, 59.222.243.9, 59.255.8.71, 59.255.8.71, 59.255.3.69, 59.255.89.43, 59.255.68.133, 59.222.243.9, 59.255.68.133, 59.255.3.69, 59.255.104.147, 59.255.3.69;\tAddress scan\tChina\tBeijing\t39.9047,116.4072\tCN\tChina\tBeijing\t39.9047,116.4072\tCN";
        log = "<12>Dec  1 18:51:11 slave4 apt: 2019-12-01 18:51:32\t1575197492219\tATD\t192.168.123.5\tNDE\t1937720e-890b-456a-b772-0e890b756a21\tp5p1\t2027265\tbad-unknown\tbad-unknown\tnull\t192.168.103.53\t46874\tnull\t59.202.42.251\t80\thttp\ttcp\thttp\tsecurity-defect\tR0VUIC9saWNlbnNlbmFtZS9zaWduL2VsY2xpY2VuY2VwZGYvcnN0L3p5anNyeXpnei9NTDAwMDA4OTBlNjVjZTM2MzM0OTYyYTgwYTAwZTRmNmZkNWI1MzA1LnBkZiBIVFRQLzEuMQ0KYWNjZXB0OiAqLyoNCnVzZXItYWdlbnQ6IE1vemlsbGEvNC4wIChjb21wYXRpYmxlOyBNU0lFIDYuMDsgV2luZG93cyBOVCA1LjE7U1YxKQ0KQ2FjaGUtQ29udHJvbDogbm8tY2FjaGUNClByYWdtYTogbm8tY2FjaGUNCkhvc3Q6IDU5LjIwMi40Mi4yNTENCkNvbm5lY3Rpb246IGtlZXAtYWxpdmUNCg0K\tnull\t1\t1\tnull\tDotted Quad Host PDF Request\tmethod:GET;status_code:200;host:59.202.42.251;uri:/licensename/sign/elclicencepdf/rst/zyjsryzgz/ML0000890e65ce36334962a80a00e4f6fd5b5305.pdf;\tDotted Quad Host PDF Request\tChina\tbeijing\t39.9047,116.4072\tCN\tChina\tBeijing\t39.9289,116.3883\tCN";
        log = "<12>Dec  1 19:42:01 slave4 apt: 2019-12-01 19:41:46\t1575200506028\t192.168.123.5\tNDE\te425758b-f87c-4995-a575-8bf87c6995f0\tp5p1\t11000022\tpolicy-violation\tweak-password\tnull\t192.168.103.23\t53858\tnull\t59.255.105.32\t8181\tnull\ttcp\thttp\tsecurity-defect\tnull\tnull\t1\t5\tnull\tnull\tmethod:POST;status_code:200;host:59.255.105.32;uri:/httpproxy;\tWeak password\tChina\tbeijing\t39.9047,116.4072\tCN\tChina\tBeijing\t39.9289,116.3883\tCN";
        log = "...IuNjcNClgtUmVxdWVzdGVkLVdpdGg6IFhNTEh0dHBSZXF1ZXN0DQpVc2VyLUFnZW50OiBNb3ppbGxhLzUuMCAoV2luZG93cyBOVCA2LjE7IFdPVzY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvNjIuMC4zMjAyLjk0IFNhZmFyaS81MzcuMzYNClJlZmVyZXI6IGh0dHA6Ly81OS4yNTUuMjIuNjcvanViYS9mcm9udC9mcm9udHBhZ2UuanNwDQpBY2NlcHQtTGFuZ3VhZ2U6IHpoLUNOLHpoO3E9MC45DQpDb29raWU6IEpTRVNTSU9OSUQ9M0NENTlFNTg2MzZFNjFCRTc1NTk1RDUyQTg3NDYzQkE7IEZTU0JCSWwxVWd6Yk43TjgwUz1wcDAxNWlFcDdtMXB2YzhESHVwR2xfaFp5UWlYdUV4Z3hHcm1XQTBUMFE0bUtnZHNhMEZIVFk0Q0tSTjdUd09QOyBKU0VTU0lPTklEPTZBQzMzNUUzMDM0NUZDMTBDQTc3RDBGNzJENUFDMjYwOyBGU1NCQklsMVVnemJON044MFQ9NG53SG5LdTUuMEluSVFRbG5FdGVBb0YxdkpDVHNQREh2ZF9mbVFIeXd5MmdwRzhlcEtDeWZkbUJwQzE5ZHd2emRJQ0VvY2ZKWU4xaWR6ekdGYTJKYWltLk5RN0tOekZHcnpVREdoVE1VZFM0ZDU4ZHp5UUlNT09MTll2ai5RRHJZR3ZGbEE4anNZdEFvOTdxSjF5UVZoRkpYWUNfcmNVOHJ1NzMyeWZXNUJOS25lQTNCcVkyclNRemU5V0FySWJZMkVFbXhkT0xFSnlncTB5alMuVkc3TmN6elFOV2xKbG5uMGlQR0J3Mm43Um82NllwM2FTSkIzTTV3cVVtWUU2NXpraUdwaFZPcml5dVVRSjRHSk5yal9LM1FTZmxzUUZKOFpub...";
        log = "<12>Dec  1 19:02:36 slave4 apt: 2019-12-01 19:03:28\t1575198208463\tATD\t192.168.123.5\tNDE\tbea8cf4d-4a92-4ff5-a8cf-4d4a925ff5b8\tp5p1\t19990502\tweird-behavior\tweird-dns-behavior\tnull\t192.168.100.50\t137\tnetbios-ns\t192.168.27.34\t137\tnetbios-ns\tudp\tdns\tactions-objectives\tKlx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAwXHgwMFx4MDBceDAw\tnull\t1\t7\tnull\tThe host 192.168.100.50 is overloaded, query str: *\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\tquery:*              ;answers:;qtype_name:NBSTAT;\tToo many DNS requests\tChina\tBeijing\t39.9047,116.4072\tCN\tChina\tBeijing\t39.9047,116.4072\tCN";
        log = "<12>Dec  4 11:26:17 slave4 apt: 2019-12-04 11:24:13\t1575429853311\tATD\t192.168.123.5\tNDE\t7f974d4e-5ac0-4e0f-974d-4e5ac05e0f1f\tp5p1\t11000022\tpolicy-violation\tweak-password\tnull\t192.168.103.23\t37144\tnull\t59.255.105.32\t8181\tnull\ttcp\thttp\tsecurity-defect\tnull\tnull\t1\t5\tnull\tnull\tmethod:POST;status_code:200;host:59.255.105.32;uri:/httpproxy;\tWeak password\tChina\tbeijing\t39.9047,116.4072\tCN\tChina\tBeijing\t39.9289,116.3883\tCN";
        log = "<12>Jan  6 02:41:47 slave4 apt: 2020-01-06 02:42:14\t1578249734915\tATD\t192.168.123.5\tNDE\t878dcf62-fea5-44e7-8dcf-62fea594e7c7\tp5p1\t10180004\tthreat-intelligence-alarm\toutbound2malicious-server\tRemote control tool Pupy\t172.31.255.9\t57644\tnull\t192.168.3.5\t443\thttps\ttcp\tssl\tremote-control\tnull\tnull\t5\t5\tRemote control tool Pupy\te35df3e00ca4ef31d42b34bebaa2f86e\tsource:5;";
        JSONObject obj = JSONUtil.createObj();
        obj.put("syslog", log);
        SyslogParse parse = new SyslogParseApt();
        System.out.println(JSONUtil.parseObj(parse.parse(obj.toString())).toJSONString(2));
    }

}
